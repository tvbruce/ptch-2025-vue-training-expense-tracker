# ğŸ¯ å€‹äººè¨˜å¸³æ‡‰ç”¨ - Pinia å¯¦æˆ°ç·´ç¿’

æ­¡è¿é€²å…¥ Pinia ç‹€æ…‹ç®¡ç†çš„å¯¦æˆ°ç·´ç¿’ï¼é€™å€‹å°ˆæ¡ˆå°‡å¹«åŠ©æ‚¨æ·±åº¦é«”é©— Vue 3 + Pinia åœ¨çœŸå¯¦æ‡‰ç”¨ä¸­çš„ä½¿ç”¨æ–¹å¼ã€‚

## ğŸ“š ç·´ç¿’æ¦‚è¿°

æœ¬å°ˆæ¡ˆæ˜¯ä¸€å€‹å®Œæ•´çš„å€‹äººè¨˜å¸³æ‡‰ç”¨ï¼Œä½†é—œéµçš„ Pinia Store é‚è¼¯å·²è¢«ç§»é™¤ï¼Œéœ€è¦æ‚¨è¦ªè‡ªå¯¦ä½œã€‚é€éé€™å€‹ç·´ç¿’ï¼Œæ‚¨å°‡å­¸æœƒï¼š

- âœ… **Pinia Store åŸºç¤çµæ§‹**ï¼šä½¿ç”¨ `defineStore` å»ºç«‹ç‹€æ…‹ç®¡ç†
- âœ… **éŸ¿æ‡‰å¼ç‹€æ…‹ç®¡ç†**ï¼šä½¿ç”¨ `ref` å’Œ `computed` ç®¡ç†ç‹€æ…‹
- âœ… **æ¥­å‹™é‚è¼¯å¯¦ä½œ**ï¼šå¯¦ç¾å®Œæ•´çš„ CRUD æ“ä½œ
- âœ… **è³‡æ–™æŒä¹…åŒ–**ï¼šèˆ‡ localStorage æ•´åˆ
- âœ… **éŒ¯èª¤è™•ç†**ï¼šå»ºç«‹å¥å£¯çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- âœ… **UI ç‹€æ…‹ç®¡ç†**ï¼šç®¡ç†å…¨åŸŸ UI ç‹€æ…‹

## ğŸ—ï¸ å°ˆæ¡ˆæ¶æ§‹

```
src/
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ transaction.js    # ğŸ”§ éœ€è¦å¯¦ä½œï¼šäº¤æ˜“è¨˜éŒ„ç®¡ç†
â”‚   â”œâ”€â”€ category.js       # ğŸ“‹ å·²å®Œæˆï¼šåˆ†é¡ç®¡ç†ï¼ˆåƒè€ƒç”¨ï¼‰
â”‚   â”œâ”€â”€ budget.js         # ğŸ’° å·²å®Œæˆï¼šé ç®—ç®¡ç†ï¼ˆåƒè€ƒç”¨ï¼‰
â”‚   â””â”€â”€ ui.js            # ğŸ”§ éœ€è¦å¯¦ä½œï¼šUI ç‹€æ…‹ç®¡ç†
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ Home.vue         # é¦–é ï¼ˆä½¿ç”¨ storesï¼‰
â”‚   â”œâ”€â”€ Transactions.vue # äº¤æ˜“è¨˜éŒ„é 
â”‚   â””â”€â”€ ...å…¶ä»–é é¢
â””â”€â”€ components/
    â””â”€â”€ ...å„ç¨®çµ„ä»¶
```

## ğŸ¯ ç·´ç¿’é‡é»

### ç¬¬ä¸€éšæ®µï¼šTransaction Storeï¼ˆæ ¸å¿ƒç·´ç¿’ï¼‰

**æª”æ¡ˆï¼š`src/stores/transaction.js`**

#### ğŸ”§ éœ€è¦å¯¦ä½œçš„å…§å®¹ï¼š

1. **éŸ¿æ‡‰å¼ç‹€æ…‹å®šç¾©**

   ```javascript
   const transactions = ref([])
   const loading = ref(false)
   const error = ref(null)
   ```

2. **è¨ˆç®—å±¬æ€§å¯¦ä½œ**

   - `balance` - ç¸½é¤˜é¡è¨ˆç®—
   - `totalIncome` - ç¸½æ”¶å…¥
   - `totalExpense` - ç¸½æ”¯å‡º
   - `monthlyIncome` - æœ¬æœˆæ”¶å…¥
   - `monthlyExpense` - æœ¬æœˆæ”¯å‡º
   - `recentTransactions` - æœ€è¿‘5ç­†äº¤æ˜“

3. **æ ¸å¿ƒæ–¹æ³•å¯¦ä½œ**
   - `loadTransactions()` - å¾ localStorage è¼‰å…¥è³‡æ–™
   - `saveTransactions()` - å„²å­˜è³‡æ–™åˆ° localStorage
   - `addTransaction()` - æ–°å¢äº¤æ˜“
   - `updateTransaction()` - æ›´æ–°äº¤æ˜“
   - `deleteTransaction()` - åˆªé™¤äº¤æ˜“

#### ğŸ’¡ å¯¦ä½œæç¤ºï¼š

**è¨ˆç®—é¤˜é¡ç¯„ä¾‹ï¼š**

```javascript
const balance = computed(() => {
  return transactions.value.reduce((total, transaction) => {
    return transaction.type === 'income' ? total + transaction.amount : total - transaction.amount
  }, 0)
})
```

**æ–°å¢äº¤æ˜“ç¯„ä¾‹ï¼š**

```javascript
function addTransaction(transactionData) {
  const newTransaction = {
    id: uuidv4(), // è¨˜å¾—å–æ¶ˆè¨»è§£ import
    ...transactionData,
    createdAt: new Date().toISOString(),
    updatedAt: new Date().toISOString(),
  }

  transactions.value.push(newTransaction)
  saveTransactions()
  return newTransaction
}
```

### ç¬¬äºŒéšæ®µï¼šUI Storeï¼ˆé€²éšç·´ç¿’ï¼‰

**æª”æ¡ˆï¼š`src/stores/ui.js`**

#### ğŸ”§ éœ€è¦å¯¦ä½œçš„å…§å®¹ï¼š

1. **å¾ localStorage è®€å–è¨­å®š**

   ```javascript
   const theme = ref(localStorage.getItem('expense-tracker-theme') || 'light')
   ```

2. **è¨ˆç®—å±¬æ€§**

   - `isDarkTheme` - æ·±è‰²ä¸»é¡Œåˆ¤æ–·
   - `hasOpenModal` - æ˜¯å¦æœ‰é–‹å•Ÿçš„æ¨¡æ…‹æ¡†

3. **UI ç‹€æ…‹ç®¡ç†æ–¹æ³•**
   - ä¸»é¡Œåˆ‡æ›å’Œè¨­å®š
   - æ¨¡æ…‹æ¡†ç®¡ç†
   - é€šçŸ¥ç³»çµ±

## ğŸ“‹ å¯¦ä½œæ­¥é©Ÿå»ºè­°

### Step 1: åŸºç¤ç‹€æ…‹å»ºç«‹ï¼ˆ15åˆ†é˜ï¼‰

1. åœ¨ `transaction.js` ä¸­å¯¦ä½œåŸºç¤ ref ç‹€æ…‹
2. å–æ¶ˆè¨»è§£ `uuidv4` import
3. æ¸¬è©¦åŸºç¤ç‹€æ…‹æ˜¯å¦å»ºç«‹æˆåŠŸ

### Step 2: è¨ˆç®—å±¬æ€§å¯¦ä½œï¼ˆ20åˆ†é˜ï¼‰

1. å¯¦ä½œ `balance` è¨ˆç®—å±¬æ€§
2. å¯¦ä½œ `totalIncome` å’Œ `totalExpense`
3. å¯¦ä½œæœˆåº¦çµ±è¨ˆç›¸é—œè¨ˆç®—å±¬æ€§
4. åœ¨ç€è¦½å™¨ä¸­æŸ¥çœ‹è¨ˆç®—çµæœ

### Step 3: CRUD æ“ä½œå¯¦ä½œï¼ˆ25åˆ†é˜ï¼‰

1. å¯¦ä½œ `addTransaction` æ–¹æ³•
2. å¯¦ä½œ `loadTransactions` å’Œ `saveTransactions`
3. å¯¦ä½œ `updateTransaction` å’Œ `deleteTransaction`
4. æ¸¬è©¦å®Œæ•´çš„å¢åˆªæ”¹æŸ¥åŠŸèƒ½

### Step 4: UI Store å¯¦ä½œï¼ˆ20åˆ†é˜ï¼‰

1. å¯¦ä½œåŸºç¤ç‹€æ…‹å’Œ localStorage æ•´åˆ
2. å¯¦ä½œä¸»é¡Œåˆ‡æ›åŠŸèƒ½
3. å¯¦ä½œæ¨¡æ…‹æ¡†ç®¡ç†
4. å¯¦ä½œé€šçŸ¥ç³»çµ±

### Step 5: æ¸¬è©¦å’Œå®Œå–„ï¼ˆ10åˆ†é˜ï¼‰

1. åœ¨é¦–é æ¸¬è©¦å„é …åŠŸèƒ½
2. æª¢æŸ¥ç€è¦½å™¨ DevTools ä¸­çš„ Pinia ç‹€æ…‹
3. æ¸¬è©¦è³‡æ–™æŒä¹…åŒ–
4. å®Œå–„éŒ¯èª¤è™•ç†

## ğŸ§ª æ¸¬è©¦æª¢æŸ¥é»

### âœ… Transaction Store æª¢æŸ¥ï¼š

- [ ] æ–°å¢äº¤æ˜“å¾Œï¼Œé¤˜é¡æ­£ç¢ºæ›´æ–°
- [ ] é‡æ–°æ•´ç†é é¢å¾Œï¼Œè³‡æ–™ä»ç„¶å­˜åœ¨
- [ ] æœ€è¿‘äº¤æ˜“åˆ—è¡¨é¡¯ç¤ºæ­£ç¢º
- [ ] æœˆåº¦çµ±è¨ˆæ•¸å­—æ­£ç¢º

### âœ… UI Store æª¢æŸ¥ï¼š

- [ ] ä¸»é¡Œåˆ‡æ›åŠŸèƒ½æ­£å¸¸
- [ ] è¨­å®šèƒ½å¤ æŒä¹…åŒ–å„²å­˜
- [ ] é€šçŸ¥ç³»çµ±é¡¯ç¤ºæ­£å¸¸

## ğŸ” é™¤éŒ¯æŠ€å·§

### 1. ä½¿ç”¨ Vue DevTools

å®‰è£ Vue DevTools æ“´å±•ç¨‹å¼ï¼Œå¯ä»¥å³æ™‚æŸ¥çœ‹ Pinia ç‹€æ…‹è®ŠåŒ–ã€‚

### 2. Console é™¤éŒ¯

åœ¨é—œéµä½ç½®åŠ å…¥ `console.log` ä¾†è¿½è¹¤è³‡æ–™æµï¼š

```javascript
function addTransaction(transactionData) {
  console.log('æ–°å¢äº¤æ˜“å‰ï¼š', transactions.value.length)
  // ...å¯¦ä½œé‚è¼¯
  console.log('æ–°å¢äº¤æ˜“å¾Œï¼š', transactions.value.length)
}
```

### 3. æª¢æŸ¥ localStorage

åœ¨ç€è¦½å™¨ DevTools çš„ Application é ç±¤ä¸­æª¢æŸ¥ localStorageã€‚

## ğŸ“– åƒè€ƒè³‡æ–™

### Pinia å®˜æ–¹æ–‡æª”ï¼š

- [Pinia åŸºæœ¬æ¦‚å¿µ](https://pinia.vuejs.org/core-concepts/)
- [Setup Stores](https://pinia.vuejs.org/core-concepts/setup-stores.html)

### Vue 3 ç›¸é—œï¼š

- [Composition API](https://vuejs.org/guide/essentials/reactivity-fundamentals.html)
- [Computed Properties](https://vuejs.org/guide/essentials/computed.html)

## ğŸ‰ å®Œæˆæª¢æŸ¥æ¸…å–®

å®Œæˆç·´ç¿’å¾Œï¼Œæ‚¨æ‡‰è©²èƒ½å¤ ï¼š

- [ ] ç†è§£ Pinia Store çš„åŸºæœ¬çµæ§‹
- [ ] ç†Ÿç·´ä½¿ç”¨ `ref` å’Œ `computed`
- [ ] å¯¦ä½œå®Œæ•´çš„ç‹€æ…‹ç®¡ç†é‚è¼¯
- [ ] æ•´åˆ localStorage å¯¦ç¾è³‡æ–™æŒä¹…åŒ–
- [ ] å»ºç«‹å¥å£¯çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- [ ] ç†è§£éŸ¿æ‡‰å¼ç‹€æ…‹å¦‚ä½•é©…å‹• UI æ›´æ–°

## ğŸ’ª é€²éšæŒ‘æˆ°

å¦‚æœæ‚¨å¿«é€Ÿå®Œæˆäº†åŸºç¤ç·´ç¿’ï¼Œå¯ä»¥å˜—è©¦ï¼š

1. **æ–°å¢æœå°‹åŠŸèƒ½**ï¼šå¯¦ä½œäº¤æ˜“è¨˜éŒ„çš„æœå°‹å’Œç¯©é¸
2. **è³‡æ–™åŒ¯å‡º**ï¼šå¯¦ä½œ CSV åŒ¯å‡ºåŠŸèƒ½
3. **æ¨‚è§€æ›´æ–°**ï¼šæ”¹é€² UI å›æ‡‰é€Ÿåº¦
4. **å¿«å–æ©Ÿåˆ¶**ï¼šåŠ å…¥æ™ºæ…§å¿«å–ç­–ç•¥
5. **éŒ¯èª¤é‡è©¦**ï¼šåŠ å…¥æ“ä½œå¤±æ•—è‡ªå‹•é‡è©¦

## ğŸ¤ ç²å¾—å¹«åŠ©

é‡åˆ°å›°é›£æ™‚ï¼š

1. **æŸ¥çœ‹è¨»è§£**ï¼šæª”æ¡ˆä¸­çš„ TODO è¨»è§£åŒ…å«è©³ç´°æç¤º
2. **åƒè€ƒå®Œæ•´å¯¦ä½œ**ï¼š`category.js` å’Œ `budget.js` æ˜¯å®Œæ•´å¯¦ä½œçš„åƒè€ƒ
3. **æŸ¥çœ‹ Console**ï¼šç•™æ„ç€è¦½å™¨æ§åˆ¶å°çš„éŒ¯èª¤è¨Šæ¯
4. **ä½¿ç”¨ DevTools**ï¼šå–„ç”¨ Vue DevTools è§€å¯Ÿç‹€æ…‹è®ŠåŒ–

ç¥æ‚¨ç·´ç¿’æ„‰å¿«ï¼é€éé€™å€‹å¯¦æˆ°ç·´ç¿’ï¼Œæ‚¨å°‡å° Pinia æœ‰æ›´æ·±å…¥çš„ç†è§£ã€‚ğŸ’ª

---

**æœ€å¾Œæé†’**ï¼šè¨˜ä½ï¼Œç¨‹å¼é–‹ç™¼æ˜¯ä¸€å€‹æŒçºŒå­¸ç¿’çš„éç¨‹ã€‚ä¸è¦å®³æ€•å‡ºéŒ¯ï¼Œæ¯å€‹éŒ¯èª¤éƒ½æ˜¯å­¸ç¿’çš„æ©Ÿæœƒï¼ğŸš€
